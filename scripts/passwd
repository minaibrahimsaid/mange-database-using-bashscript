#!/bin/bash
user=$1
db_user=`egrep :$user: ../system/passwd`
if [ $db_user ]
	then
	username=`echo $db_user | cut -d: -f2`
	user_id=`echo $db_user | cut -d: -f1`
	read -p 'Enter old password: ' old
	old_pass=`echo -n $old| md5 | awk '{ print $1 }'`
	passwrd=`echo $db_user | cut -d: -f3`
	if [ $passwrd  == $old_pass ]
		then
		read -p 'Enter new password: ' new_pass
		read -p 'Confirm new password: ' confirm_pass
		if [ $new_pass  == $confirm_pass ]
			then
			pass=`echo -n $new_pass| md5 | awk '{ print $1 }'`
			#update the record in system/passwd
			#egrep ^$user_id:.*:$old_pass ../system/passwd
			sed -i "s/^${user_id}.*/$user_id:${user}:$pass/" ../system/passwd
			# sed 's/$old_pass/p' ../system/passwd
		else
			echo -2 #confirmation error	
		fi
	else
		echo 0 #wrong password
	fi
else
	echo -1 #not found	
fi		